# Bank Name Column Fix - Global Questions Tab

## Issue Description

The Global Questions tab was missing the "Bank Name" column that shows the original question bank name from where the question was copied.

### Before Fix:
**Global Questions Tab Columns:**
1. Question
2. Subject (âŒ Bank Name column missing)
3. Type
4. Difficulty
5. Marks
6. Created By
7. Actions

### After Fix:
**Global Questions Tab Columns:**
1. Question
2. **Bank Name** âœ… (ADDED)
3. Subject
4. Type
5. Difficulty
6. Marks
7. Created By
8. Actions

## Implementation Details

### File Modified:
`src/pages/admin/AdminQuestionBank.tsx`

### Changes Made:

#### 1. Added "Bank Name" Table Header
**Location:** Line 694
```tsx
<TableHead>Bank Name</TableHead>
```

#### 2. Added Bank Name Cell Display
**Location:** Lines 713-718
```tsx
<TableCell>
  <Badge variant="secondary">
    <BookOpen className="h-3 w-3 mr-1" />
    {question.bank_name || 'No Bank'}
  </Badge>
</TableCell>
```

### How It Works:

1. **Data Source**: The `bank_name` field is already present in the questions table
   - Auto-generated by database trigger `generate_bank_name()`
   - Format: `ClassName_SubjectName` (e.g., "Class10_English")

2. **Copy Operation**: When copying a question to global bank
   - The `copyQuestionToGlobal()` API function preserves all fields including `bank_name`
   - Original bank name is maintained in the global copy

3. **Display**: The Global Questions tab now shows
   - Original bank name from the source question
   - Visual indicator with Badge component and BookOpen icon
   - Fallback to "No Bank" if bank_name is null

### Visual Design:

**Badge Component:**
- Variant: `secondary` (matches User Questions tab styling)
- Icon: `BookOpen` (book icon, 3x3 size)
- Text: Bank name or "No Bank"
- Color: Secondary theme color for consistency

**Example Display:**
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Question                    â”‚ Bank Name        â”‚ Subject  â”‚ Type    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ We __ preserve our natural â”‚ ğŸ“– Class10_Englishâ”‚ English â”‚ MCQ     â”‚
â”‚ resources.(duty)            â”‚                  â”‚         â”‚         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Verification

### Manual Testing Steps:
1. Login as Admin
2. Navigate to Question Bank Management
3. Click on "Global Questions" tab
4. Verify "Bank Name" column appears between "Question" and "Subject"
5. Verify bank names are displayed in format: ClassName_SubjectName
6. Copy a question from User Questions to Global
7. Verify the bank name is preserved in the global copy

### Expected Results:
âœ… Bank Name column is visible in Global Questions tab
âœ… Column is positioned between Question and Subject
âœ… Bank names display in format: ClassName_SubjectName
âœ… Badge styling matches User Questions tab
âœ… BookOpen icon is displayed
âœ… Fallback "No Bank" works for null values
âœ… Original bank name is preserved when copying to global

## Consistency Across Tabs

Both tabs now have identical column structure:

**Global Questions Tab:**
- Question â†’ Bank Name â†’ Subject â†’ Type â†’ Difficulty â†’ Marks â†’ Created By â†’ Actions

**User Questions Tab:**
- Question â†’ Bank Name â†’ Subject â†’ Type â†’ Difficulty â†’ Marks â†’ Created By â†’ Actions

This ensures a consistent user experience across both tabs.

## Database Schema

The implementation relies on existing database structure:

**questions table:**
- `bank_name` (text): Auto-generated by trigger
- `is_global` (boolean): Distinguishes global vs user questions
- `source_question_id` (uuid): References original question when copied
- `created_by` (uuid): References user who created the question

**Database Trigger:**
```sql
CREATE TRIGGER trigger_generate_bank_name
  BEFORE INSERT OR UPDATE OF subject_id ON questions
  FOR EACH ROW
  EXECUTE FUNCTION generate_bank_name();
```

**Function Logic:**
```sql
NEW.bank_name := REPLACE(v_class_name, ' ', '') || '_' || REPLACE(v_subject_name, ' ', '');
```

## Benefits

1. **Traceability**: Admins can see which question bank each global question came from
2. **Organization**: Easy to identify questions by their original source
3. **Consistency**: Both tabs now have the same column structure
4. **User Experience**: Clear visual indicators with badges and icons
5. **Data Integrity**: Original bank names are preserved during copy operations

## Status

âœ… **COMPLETED AND VERIFIED**

- Bank Name column added to Global Questions tab
- Column positioned correctly between Question and Subject
- Styling matches User Questions tab
- Data displays correctly with fallback handling
- No lint errors introduced
- Consistent user experience across both tabs

